!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/material/checkbox"),require("@covalent/highlight"),require("@covalent/markdown"),require("@covalent/core/data-table"),require("@angular/common"),require("@angular/material/list"),require("@angular/material/progress-bar"),require("@angular/material/button")):"function"==typeof define&&define.amd?define("@covalent/flavored-markdown",["exports","@angular/core","@angular/material/checkbox","@covalent/highlight","@covalent/markdown","@covalent/core/data-table","@angular/common","@angular/material/list","@angular/material/progress-bar","@angular/material/button"],t):t(((e=e||self).covalent=e.covalent||{},e.covalent["flavored-markdown"]={}),e.ng.core,e.ng.material.checkbox,e.covalent.highlight,e.covalent.markdown,e.covalent.core["data-table"],e.ng.common,e.ng.material.list,e.ng.material.progressBar,e.ng.material.button)}(this,(function(e,t,n,o,r,i,a,s,c,l){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function p(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}function u(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}var f=function(){function e(){this.dense=!1}return e.decorators=[{type:t.Component,args:[{selector:"cfm-list",template:'<mat-list [attr.dense]="dense ? true : null">\n  <ng-template let-line let-last="last" ngFor [ngForOf]="lines">\n    <mat-list-item>\n      <h4 matLine>\n        {{ line.line }}\n      </h4>\n      <p *ngFor="let subline of line.sublines" matLine>\n        {{ subline }}\n      </p>\n      <mat-divider *ngIf="!last"></mat-divider>\n    </mat-list-item>\n  </ng-template>\n</mat-list>\n',styles:[""]}]}],e.propDecorators={lines:[{type:t.Input}],dense:[{type:t.Input}]},e}();var m=function(){function e(){this.display="inline-block",this.text="",this.data="",this.clicked=new t.EventEmitter}return e.prototype.emitClick=function(){this.clicked.emit({text:this.text,data:this.data})},e.decorators=[{type:t.Component,args:[{template:'\n    <button mat-raised-button (click)="emitClick()">\n      {{ text }}\n    </button>\n  '}]}],e.propDecorators={display:[{type:t.HostBinding,args:["style.display"]}],text:[{type:t.Input}],data:[{type:t.Input}],clicked:[{type:t.Output}]},e}();var y=function(){function e(e,t){this.viewContainerRef=e,this._renderer=t}return e.prototype.clear=function(){this._renderer.setProperty(this.viewContainerRef.element.nativeElement,"innerHTML",""),this.viewContainerRef.clear()},e.decorators=[{type:t.Directive,args:[{selector:"[tdFlavoredMarkdownContainer]"}]}],e.ctorParameters=function(){return[{type:t.ViewContainerRef},{type:t.Renderer2}]},e}();var g=function(){function e(e,n,o,r,i){this._componentFactoryResolver=e,this._renderer=n,this._changeDetectorRef=o,this._injector=r,this._elementRef=i,this._simpleLineBreaks=!1,this._components={},this._viewInit=!1,this.copyCodeToClipboard=!1,this.copyCodeTooltips={},this.contentReady=new t.EventEmitter,this.buttonClicked=new t.EventEmitter}return Object.defineProperty(e.prototype,"content",{set:function(e){this._content=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"simpleLineBreaks",{set:function(e){this._simpleLineBreaks=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostedUrl",{set:function(e){this._hostedUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{set:function(e){this._anchor=e},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){!e.anchor||e.content||e.simpleLineBreaks||e.hostedUrl?this.refresh():r.scrollToAnchor(this._elementRef.nativeElement,this._anchor,!1)},e.prototype.ngAfterViewInit=function(){var e=this;this._content||(this._loadContent(this.container.viewContainerRef.element.nativeElement.textContent),Promise.resolve().then((function(){e._viewInit=!0,e._changeDetectorRef.markForCheck()})))},e.prototype.refresh=function(){this._content?this._loadContent(this._content):this._viewInit&&this._loadContent(this.container.viewContainerRef.element.nativeElement.textContent),this._changeDetectorRef.markForCheck()},e.prototype._loadContent=function(e){var t=this;if(e&&e.trim().length>0){this.container.clear();var n=(e=e.replace(/^(\s|\t)*\n+/g,"").replace(/(\s|\t)*\n+(\s|\t)*$/g,"")).split("\n"),o=n[0].match(/^(\s|\t)*/)[0],i=new RegExp("^"+o);n=n.map((function(e){return e.replace(i,"")})),e=h(n,["",""]).join("\n"),e=this._replaceCodeBlocks(e),e=this._replaceCheckbox(e),e=this._replaceTables(e),e=this._replaceLists(e),e=this._replaceButtons(e);var a=Object.keys(this._components);a.sort((function(t,n){return e.indexOf(t)>e.indexOf(n)?1:-1})),this._render(e,a[0],a),setTimeout((function(){return r.scrollToAnchor(t._elementRef.nativeElement,t._anchor,!1)}),250),this.contentReady.emit(),Promise.resolve().then((function(){t._changeDetectorRef.markForCheck()}))}},e.prototype._render=function(e,t,n){if(e)if(t&&e.indexOf(t)>-1){var o=e.split(t);n.shift(),this._render(o[0],void 0,void 0),this.container.viewContainerRef.insert(this._components[t].hostView,this.container.viewContainerRef.length),this._components[t]=void 0,delete this._components[t],this._render(o[1],n[0],n)}else{var i=this._componentFactoryResolver.resolveComponentFactory(r.TdMarkdownComponent).create(this._injector);i.instance.content=e,i.instance.hostedUrl=this._hostedUrl,i.instance.simpleLineBreaks=this._simpleLineBreaks,i.instance.refresh(),this.container.viewContainerRef.insert(i.hostView,this.container.viewContainerRef.length)}},e.prototype._replaceComponent=function(e,t,n,o){var r=this,i=0;return e.replace(n,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=r._componentFactoryResolver.resolveComponentFactory(t),s=a.create(r._injector);o.apply(void 0,h([s],e));var c="["+a.selector+"-placeholder-"+i+++"]";return r._components[c]=s,c}))},e.prototype._replaceCheckbox=function(e){var t=this;return this._replaceComponent(e,n.MatCheckbox,/(?:^|\n)- \[(x| )\](.*)/gi,(function(e,n,o,r){e.instance.checked=!!o.trim(),e.instance.disabled=!0,e.instance.labelPosition="after",t._renderer.setProperty(e.instance._elementRef.nativeElement.getElementsByClassName("mat-checkbox-label")[0],"innerHTML",r)}))},e.prototype._replaceButtons=function(e){var t=this,n=/\[([^\[]+)\](\(#data=(.*)\))/i,o=new RegExp(n.source,n.flags+"g");return this._replaceComponent(e,m,o,(function(e,o){var r=n.exec(o),i=r[1],a=r[3];e.instance.text=i,e.instance.data=a,e.instance.clicked.subscribe((function(e){return t.buttonClicked.emit(e)}))}))},e.prototype._replaceCodeBlocks=function(e){var t=this;return this._replaceComponent(e,o.TdHighlightComponent,/(?:^|\n)```(.*)\n([\s\S]*?)\n```/g,(function(e,n,o,r){o&&(e.instance.lang=o),e.instance.copyCodeToClipboard=t.copyCodeToClipboard,e.instance.copyCodeTooltips=t.copyCodeTooltips,e.instance.content=r}))},e.prototype._replaceTables=function(e){return this._replaceComponent(e,i.TdDataTableComponent,/^ {0,3}\|?.+\|.+\n[ \t]{0,3}\|?[ \t]*:?[ \t]*(?:-|=){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:-|=){2,}[\s\S]+?(?:\n\n|~0)/gm,(function(e,t){var n=t.replace(/(\s|\t)*\n+(\s|\t)*$/g,"").split("\n"),o=n[0].split("|").filter((function(e){return e})).map((function(e){return e.trim()})),r=n[1].split("|").filter((function(e){return e})).map((function(e){return e.trim()}));e.instance.columns=o.map((function(e,t){var n=r[t].split("---"),o=parseInt(n[0],10),i=parseInt(n[1],10),a={min:o,max:i};return isNaN(o)&&isNaN(i)?a=void 0:isNaN(i)?a.max=void 0:isNaN(o)&&(a.min=void 0),{label:e,name:e.toLowerCase().trim(),numeric:/^--*[ \t]*:[ \t]*$/.test(r[t]),width:a}}));for(var a=[],s=function(e){var t=n[e].split("|").filter((function(e){return e})).map((function(e){return e.trim()})),r={};o.forEach((function(e,n){var o=t[n];o&&(r[e.toLowerCase().trim()]=o.replace(/`(.*)`/,(function(e,t){return t})))})),a.push(r)},c=2;c<n.length;c++)s(c);e.instance.data=a,e.instance.sortable=!0,e.instance.sortChange.subscribe((function(t){e.instance.data.sort((function(e,n){var o=e[t.name],r=n[t.name],a=0;return Number.isNaN(Number.parseFloat(o))||Number.isNaN(Number.parseFloat(r))?o<r?a=-1:o>r&&(a=1):a=Number.parseFloat(o)-Number.parseFloat(r),a*(t.order===i.TdDataTableSortingOrder.Descending?-1:1)})),e.instance.refresh()})),setTimeout((function(){e.instance.refresh()}))}))},e.prototype._replaceLists=function(e){return this._replaceComponent(e,f,/(?:^|\n)(( *\+)[ |\t](.*)\n)+/g,(function(e,t){var n=t.split(new RegExp("\\n {"+(t.indexOf("+")-1).toString()+"}\\+[ |\\t]"));n.shift();var o=[];n.forEach((function(e,t){var n=e.split(/\n *\+ /);o.push({line:n.shift(),sublines:n.map((function(e){return e.trim()}))})})),e.instance.lines=o}))},e.decorators=[{type:t.Component,args:[{selector:"td-flavored-markdown",template:"<div tdFlavoredMarkdownContainer>\n  <ng-content></ng-content>\n</div>\n",changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[':host ::ng-deep td-markdown:first-of-type>div:first-of-type>h1:first-of-type,:host ::ng-deep td-markdown:first-of-type>div:first-of-type>h2:first-of-type{margin-top:0}:host ::ng-deep mat-checkbox,:host ::ng-deep td-data-table{display:block}:host ::ng-deep mat-checkbox:last-of-type,:host ::ng-deep td-data-table,:host ::ng-deep td-highlight{margin-bottom:16px}:host ::ng-deep :not(pre)>code{font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;padding-left:2px;padding-right:2px}:host ::ng-deep td-highlight{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}']}]}],e.ctorParameters=function(){return[{type:t.ComponentFactoryResolver},{type:t.Renderer2},{type:t.ChangeDetectorRef},{type:t.Injector},{type:t.ElementRef}]},e.propDecorators={content:[{type:t.Input,args:["content"]}],simpleLineBreaks:[{type:t.Input,args:["simpleLineBreaks"]}],hostedUrl:[{type:t.Input,args:["hostedUrl"]}],anchor:[{type:t.Input,args:["anchor"]}],copyCodeToClipboard:[{type:t.Input}],copyCodeTooltips:[{type:t.Input}],contentReady:[{type:t.Output}],buttonClicked:[{type:t.Output}],container:[{type:t.ViewChild,args:[y,{static:!0}]}]},e}();var v=function(){function e(e,n){this._changeDetectorRef=e,this._markdownUrlLoaderService=n,this.copyCodeToClipboard=!1,this.copyCodeTooltips={},this.contentReady=new t.EventEmitter,this.loadFailed=new t.EventEmitter,this.buttonClicked=new t.EventEmitter,this.loading=!0}return e.prototype.ngOnChanges=function(e){(e.url||e.httpOptions)&&this.loadMarkdown()},e.prototype.loadMarkdown=function(){return p(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:this.loading=!0,this._changeDetectorRef.markForCheck(),n.label=1;case 1:return n.trys.push([1,3,4,5]),e=this,[4,this._markdownUrlLoaderService.load(this.url,this.httpOptions)];case 2:return e.content=n.sent(),[3,5];case 3:return t=n.sent(),this.loadFailed.emit(t),[3,5];case 4:return this.loading=!1,this._changeDetectorRef.markForCheck(),[7];case 5:return[2]}}))}))},e.decorators=[{type:t.Component,args:[{selector:"td-flavored-markdown-loader",template:'<mat-progress-bar\n  [ngClass]="\'delay\'"\n  *ngIf="loading"\n  mode="indeterminate"\n  color="accent"\n  class="sticky"\n></mat-progress-bar>\n<td-flavored-markdown\n  *ngIf="!loading"\n  [content]="content"\n  [hostedUrl]="url"\n  [anchor]="anchor"\n  [copyCodeToClipboard]="copyCodeToClipboard"\n  [copyCodeTooltips]="copyCodeTooltips"\n  (contentReady)="contentReady.emit()"\n  (buttonClicked)="buttonClicked.emit($event)"\n></td-flavored-markdown>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,styles:[":host{display:block}.sticky{position:absolute;top:0}.delay{-webkit-animation:.6s delayAnimation;animation:.6s delayAnimation}@-webkit-keyframes delayAnimation{0%,99%{opacity:0}100%{opacity:1}}@keyframes delayAnimation{0%,99%{opacity:0}100%{opacity:1}}"]}]}],e.ctorParameters=function(){return[{type:t.ChangeDetectorRef},{type:r.TdMarkdownLoaderService}]},e.propDecorators={url:[{type:t.Input}],httpOptions:[{type:t.Input}],anchor:[{type:t.Input}],copyCodeToClipboard:[{type:t.Input}],copyCodeTooltips:[{type:t.Input}],contentReady:[{type:t.Output}],loadFailed:[{type:t.Output}],buttonClicked:[{type:t.Output}]},e}();var b=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[a.CommonModule,n.MatCheckboxModule,s.MatListModule,c.MatProgressBarModule,i.CovalentDataTableModule,o.CovalentHighlightModule,r.CovalentMarkdownModule,l.MatButtonModule],declarations:[f,g,y,v,m],exports:[g,v]}]}],e}();e.CovalentFlavoredMarkdownModule=b,e.TdFlavoredMarkdownButtonComponent=m,e.TdFlavoredMarkdownComponent=g,e.TdFlavoredMarkdownContainerDirective=y,e.TdFlavoredMarkdownLoaderComponent=v,e.ɵa=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=covalent-flavored-markdown.umd.min.js.map